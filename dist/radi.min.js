!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd||e(t.radi={})}(this,function(t){"use strict";var e=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,n=/\bl\(/g,r="(".charCodeAt(0),i=")".charCodeAt(0),o="#".charCodeAt(0),a=".".charCodeAt(0),c=!1,s=Object.prototype,u=function(t){return t&&t.__proto__===s},f=function(t){return!0===Array.isArray(t)};function l(t){var e,n;if("object"==typeof t){if(null===t)return t;if("[object Array]"===Object.prototype.toString.call(t)){var r=t.length;for(n=new Array(r),e=0;e<r;e++)"object"==typeof t[e]?n[e]=l(t[e]):n[e]=t[e]}else for(e in n={},t)t.hasOwnProperty(e)&&(t[e],n[e]=l(t[e]))}else n=t;return n}Object.defineProperties(Object,{relocate:{configurable:!0,enumerable:!1,value:function(t,e){for(var n in e){const i=e[n];var r=!1;!i||"object"!=typeof i||i instanceof $?t[n]!==i&&(r=!0,t[n]=i):(void 0===t[n]&&(t[n]=i.constructor()),Object.relocate(t[n],i),r=!0),r&&h(t,n)}},writable:!0}});var p=function(t,e){var n=()=>{},r=t=>({value:function(){return function(){var t=this[0].length,e=l(this[0]),n=Array.prototype[this[1]].apply(e,arguments),r=e.length,i=r-t;if(this[0].length=r,i<0)for(var o=t;o>t+i;o--)delete this[0][o-1+"__ob__"],delete this[0][o-1];return Object.relocate(this[0],e),0!==i&&this[0]._r_set(i,this[0]),n}.apply([this,t],arguments)}});e._r_set={value:function(e){if(c)return!1;n(e,t)}},e._r_get={value:function(t){n=t}},e.push=r("push"),e.pop=r("pop"),e.splice=r("splice"),e.shift=r("shift"),e.unshift=r("unshift"),e.reverse=r("reverse")},h=function(t,e){if(void 0!==t[e+"__ob__"])return!1;var n={__r:{value:!0}};return f(t)&&void 0===t.__r&&!t.__r&&p(t,n),n[e+"__ob__"]={value:v(t,e),configurable:!0},"object"==typeof t[e]&&d(t[e],t.__path+"."+e),Object.defineProperties(t,n)},d=function t(e,n){var r=void 0===n?"this":n;if(e&&"object"==typeof e){var i={__r:{value:!0},__path:{value:r}};if(f(e))for(var o in void 0!==e.__r||e.__r||p(e,i),e)void 0===e[o+"__ob__"]&&(i[o+"__ob__"]={value:v(e,o),configurable:!0},t(e[o],r+"."+o));else if(u(e))for(var o in e)void 0===e[o+"__ob__"]&&(i[o+"__ob__"]={value:v(e,o),configurable:!0},t(e[o],r+"."+o));return Object.defineProperties(e,i)}return!1},v=function(t,e){return new _(t,e)},_=function(t,e){var n=t;this.watch=function(t){g(n,e,(t,e,n)=>n)},this.prop=e,this.data=function(){return n},this.get=function(){return n[e]}},b=Object.getOwnPropertyDescriptor,g=function(t,e,n){t[e],void 0!==b(t,e)&&b(t,e).set;delete t[e]},y=function(t,e){var n=function(t){for(var e=null,n=null,r=null,i=0,c="",s=0;s<=t.length;s++){var u=t.charCodeAt(s),f=u===o,l=u===a;f||l||!u?(0===i?e=0===s?"div":c:1===i?n=c:r?r+=" "+c:r=c,f?i=1:l&&(i=2),c=""):c+=t[s]}return{tag:e,id:n,className:r}}(t),r=n.tag,i=n.id,c=n.className,s=e?document.createElementNS(e,r):document.createElement(r);return i&&(s.id=i),c&&(e?s.setAttribute("class",c):s.className=c),s};Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var m=0;const w=[];var $=function(t){var e={};for(var n in t.state){if(void 0!==e[n])throw new Error("[Radi.js] Err: Trying to write state for reserved variable `"+n+"`");e[n]=t.state[n]}for(var n in t.props){if(void 0!==e[n])throw new Error("[Radi.js] Err: Trying to write prop for reserved variable `"+n+"`");k(t.props[n])?(e[n]=t.props[n].get(),t.props[n].watch(function(t){e[n]=t})):e[n]=t.props[n]}for(var n in d(e),t.actions){if(void 0!==e[n])throw new Error("[Radi.js] Error: Trying to write action for reserved variable `"+n+"`");{const r=t.actions[n];e[n]=function(){return c?function(){}:r.apply(e,arguments)},function(t){e[t]}(n)}}return e.$id=m++,e.$name=t.name,e.$state=t.state||{},e.$props=t.props||{},e.$actions=t.actions||{},e.$html=document.createDocumentFragment(),e.$view=new Function("r","list","l","cond","return "+t.$view)(z.bind(e),W.bind(e),H.bind(e),q.bind(e)),e.$render=function(){return e.$link=e.$view(),e.$link.unmount=e.unmount.bind(e),e.$html.appendChild(e.$link),e.mount(),e.$html},e.mount=function(){"function"==typeof e.$actions.onMount&&e.$actions.onMount.call(e),w.push(e)},e.unmount=function(){"function"==typeof e.$actions.onDestroy&&e.$actions.onDestroy.call(e);for(var t=0;t<w.length;t++)if(w[t].$id===e.$id){w.splice(t,1);break}return e.$link},e},j=function t(e){if("function"==typeof e.unmount&&e.unmount(),e.children&&e.children.length>0)for(var n=0;n<e.children.length;n++)t(e.children[n])},A=function(t,e,n){var r=O(t);if(k(n))r.style[e]=n.get(),n.watch(t=>{});else if(void 0!==n)r.style[e]=n;else if(E(e))r.setAttribute("style",e);else for(var i in e)A(r,i,e[i])},C=function(t,e,n){var r=this,i=O(t);if(void 0!==n)if("style"===e)A(i,n);else if("model"===e&&k(n))i.value=n.get(),i.oninput=function(){n.data()[n.prop]=i.value},n.watch(function(t){});else if(x(n))i[e]=function(t){n.call(r,t)};else if(k(n)){var o=n.get();x(o)?i[e]=function(t){n.get().call(r,t)}:(i.setAttribute(e,n.get()),n.watch(function(t){}))}else i.setAttribute(e,n);else for(var a in e)C.call(this,i,a,e[a])},O=function(t){return t.nodeType&&t||!t.el&&t||O(t.el)},E=function(t){return"string"==typeof t},N=function(t){return"number"==typeof t},x=function(t){return"function"==typeof t},S=function(t){return t&&t.nodeType},k=function(t){return t&&t instanceof _},D=function(t){return t&&t instanceof G},T=function(t){return t&&t.__radi};const M=function(t){return document.createTextNode(t)};var P=function(t,e){for(var n=0;n<e.length;n++){var r=e[n];if(0===r||r)if(T(r))t.appendChild(r.__radi().$render());else if(D(r)){var i,o=r.__do(),a=o.id;i=T(o.r)?o.r.__radi().$render():"function"==typeof o.r?o.r():E(o.r)||N(o.r)?M(o.r):o.r,t.appendChild(i),function(t){t.watch(function(e){var n,r=t.__do();if(a===r.id)return!1;n=T(r.r)?r.r.__radi().$render():"function"==typeof r.r?r.r():E(r.r)||N(r.r)?M(r.r):r.r,j(i),i.parentNode.replaceChild(n,i),i=n,a=r.id})}(r)}else if("function"==typeof r)r.call(this,t);else if(E(r)||N(r))t.appendChild(M(r));else if(S(O(r)))t.appendChild(r);else if(Array.isArray(r))P.call(this,t,r);else if(k(r)){let e=M(r.get());t.appendChild(e),r.watch(function(t){})}else"object"==typeof r&&C.call(this,t,r)}},F={},R=function(t){return F[t]||(F[t]=y(t))};const z=function(t){for(var e,n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];return e=E(t)?R(t).cloneNode(!1):S(t)?t.cloneNode(!1):document.createDocumentFragment(),P.call(this,e,n),e};z.extend=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var r=R(t);return z.bind.apply(z,[this,r].concat(e))};var B=function(t){this.o={name:t.name,state:l(t.state),props:l(t.props),actions:t.actions,view:t.view,$view:t.$view},this.__radi=function(){return new $(this.o)}};B.prototype.props=function(t){for(var e in t)void 0===this.o.props[e]&&console.warn("[Radi.js] Warn: Creating a prop `",e,"` that is not defined in component"),this.o.props[e]=t[e];return this};var I=M("");const W=function(t,e){if(!t)return"";var n,r=this,i=document.createDocumentFragment(),o=I.cloneNode();i.appendChild(o);var a=t.get();if(f(a))for(var c=0;c<a.length;c++)a[c+"__ob__"].watch(t=>{}),i.appendChild(e.call(r,a[c],c));else{c=0;for(var s in a)a[c+"__ob__"].watch(t=>{}),i.appendChild(e.call(r,a[s],s,c)),c++}n=i.lastChild;var u=function(t,o){if(t>0){for(var a=o.length-t;a<o.length;a++)o[a+"__ob__"].watch(t=>{}),i.appendChild(e.call(r,o[a],a));var c=i.lastChild;n.parentElement.insertBefore(i,n.nextSibling),n=c}else if(t<0)for(a=0;a<Math.abs(t);a++){var s=n.previousSibling;n.parentElement.removeChild(n),n=s}};return t.watch&&t.watch(u),t.get&&t.get()._r_get&&t.get()._r_get(u),i},Z=function(t,e,n){var r,i={s:null},o=this,a=t.bind(this);if(1===n.length&&t.toString().replace(/(function \(\)\{ return |\(|\)|\; \})/g,"").trim()===n[0])return e[0];for(var c=0;c<e.length;c++)k(e[c])&&(r=!0,e[c].watch(function(){i.s=a(o)}));return i.s=a(o),r?v(i,"s"):i.s},q=function(t,e){return new G(t,e)};var G=function(t,e){this.cases=[{a:t,e:e}],this.w=[],this.els=I.cloneNode(),k(t)&&this.w.push(t),this.watch=function(t){for(var e in this.w)this.w[e].watch(t)},this.__do=function(){var t={id:null};for(var e in this.cases){if(k(this.cases[e].a)?this.cases[e].a.get():this.cases[e].a){t.id=e,t.r=this.cases[e].e;break}}return void 0===t.r&&(t.r=this.els),t}};G.prototype.elseif=function(t,e){return this.cases.push({a:t,e:e}),k(t)&&this.w.push(t),this},G.prototype.cond=G.prototype.elseif,G.prototype.else=function(t){return this.els=t,this};const H=function(t,e,n){return e?Z.call(this,t,e,n.split(",")):t};t.version="0.0.5",t.activeComponents=w,t.text=M,t.r=z,t.component=function(t){for(var o=t.view.toString().replace(e,""),a=n.exec(o),c=[],s=0;null!==a;){var u=a.index,f=a.input,l=1,p=0;const t=f.length;for(var h=u+2;h<t;h++){var d=f.charCodeAt(h);if(d===r?l+=1:d===i&&(p+=1),l===p)break}var v=f.substr(u,h+1-u),_=v.match(/[a-zA-Z_$]+(?:\.\w+(?:\[.*\])?)+/g)||[],b=_.length>0?_.join("__ob__,")+"__ob__":"",g="l(function(){ return "+v.substr(1)+"; },["+b+'], "'+_.join(",")+'")';c.push(o.substr(s,u-s)),c.push(g),s=u+v.length,a=n.exec(o)}return c.push(o.substr(s,o.length-s)),t.$view=c.join(""),B.bind(this,t)},t.mount=function(t,e){const n=e.constructor===String?document.getElementById(e):e;var r=t instanceof B?t.__radi().$render():t;return n.appendChild(r),r},t.list=W,t.link=Z,t.cond=q,t.l=H,t.freeze=(()=>{c=!0}),t.unfreeze=(()=>{c=!1;for(var t=0;t<w.length;t++)"function"==typeof w[t].onMount&&w[t].onMount.call(w[t])})});
//# sourceMappingURL=radi.js.map