!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd||e(t.radi={})}(this,function(t){"use strict";var e=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,n=/\bl\(/g,r="(".charCodeAt(0),i=")".charCodeAt(0),o="#".charCodeAt(0),a=".".charCodeAt(0),s=!1,c=Object.prototype,u=function(t){return t&&t.__proto__===c},l=function(t){return!0===Array.isArray(t)};function f(t){var e,n;if("object"==typeof t){if(null===t)return t;if("[object Array]"===Object.prototype.toString.call(t)){var r=t.length;for(n=new Array(r),e=0;e<r;e++)"object"==typeof t[e]?n[e]=f(t[e]):n[e]=t[e]}else for(e in n={},t)t.hasOwnProperty(e)&&(t[e],n[e]=f(t[e]))}else n=t;return n}Object.defineProperties(Object,{relocate:{configurable:!0,enumerable:!1,value:function(t,e){for(var n in e){const i=e[n];var r=!1;!i||"object"!=typeof i||i instanceof j?t[n]!==i&&(r=!0,t[n]=i):(void 0===t[n]&&(t[n]=i.constructor()),Object.relocate(t[n],i),r=!0),r&&d(t,n)}},writable:!0}});var h=function(){var t=this[0].length,e=f(this[0]),n=Array.prototype[this[1]].apply(e,arguments),r=e.length,i=r-t;if(this[0].length=r,i<0)for(var o=t;o>t+i;o--)delete this[0][o-1+"__ob__"],delete this[0][o-1];return Object.relocate(this[0],e),0!==i&&this[0]._r_set(i,this[0]),n},p=function(t,e){var n=()=>{};e._r_set={value:function(e){if(s)return!1;n(e,t)}},e._r_get={value:function(t){n=t}},e.push={value:function(){return h.apply([this,"push"],arguments)}},e.pop={value:function(){return h.apply([this,"pop"],arguments)}},e.splice={value:function(){return h.apply([this,"splice"],arguments)}},e.shift={value:function(){return h.apply([this,"shift"],arguments)}},e.unshift={value:function(){return h.apply([this,"unshift"],arguments)}},e.reverse={value:function(){return h.apply([this,"reverse"],arguments)}}},d=function(t,e){if(void 0!==t[e+"__ob__"])return!1;var n={__r:{value:!0}};return l(t)&&void 0===t.__r&&!t.__r&&p(t,n),n[e+"__ob__"]={value:_(t,e),configurable:!0},"object"==typeof t[e]&&v(t[e]),Object.defineProperties(t,n)},v=function t(e){if(e&&"object"==typeof e){var n={__r:{value:!0}};if(l(e))for(var r in void 0!==e.__r||e.__r||p(e,n),e)void 0===e[r+"__ob__"]&&(n[r+"__ob__"]={value:_(e,r),configurable:!0},t(e[r]));else if(u(e))for(var r in e)void 0===e[r+"__ob__"]&&(n[r+"__ob__"]={value:_(e,r),configurable:!0},t(e[r]));return Object.defineProperties(e,n)}return!1},_=function(t,e){return new b(t,e)},b=function(t,e){var n=t;this.watch=function(t){g(n,e,(t,e,n)=>n)},this.prop=e,this.data=function(){return n},this.get=function(){return n[e]}},y=Object.getOwnPropertyDescriptor,g=function(t,e,n){t[e],void 0!==y(t,e)&&y(t,e).set;delete t[e]},m=function(t,e){var n=function(t){for(var e=null,n=null,r=null,i=0,s="",c=0;c<=t.length;c++){var u=t.charCodeAt(c),l=u===o,f=u===a;l||f||!u?(0===i?e=0===c?"div":s:1===i?n=s:r?r+=" "+s:r=s,l?i=1:f&&(i=2),s=""):s+=t[c]}return{tag:e,id:n,className:r}}(t),r=n.tag,i=n.id,s=n.className,c=e?document.createElementNS(e,r):document.createElement(r);return i&&(c.id=i),s&&(e?c.setAttribute("class",s):c.className=s),c};Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var w=0;const $=[];class j{constructor(t){var e=t.state||{},n=t.props||{},r=t.actions||{};t.view;this.$id=w++,this.$this={};var i=this.$this;for(var o in e){if(void 0!==i[o])throw new Error("[Radi.js] Err: Trying to write state for reserved variable `"+o+"`");i[o]=e[o]}for(var o in n){if(void 0!==i[o])throw new Error("[Radi.js] Err: Trying to write prop for reserved variable `"+o+"`");S(n[o])?(i[o]=n[o].get(),n[o].watch(function(t){i[o]=t})):i[o]=n[o]}for(var o in v(i),r){if(void 0!==i[o])throw new Error("[Radi.js] Error: Trying to write action for reserved variable `"+o+"`");{const t=r[o];i[o]=function(){return s?function(){}:t.apply(i,arguments)},function(t,e){t[e]}(i,o)}}i.$id=this.$id,i.$name=t.name,i.$state=e,i.$props=n,i.$actions=r,this.$html=document.createDocumentFragment(),this.$view=new Function("r","list","l","cond","return "+t.$view)(z.bind(i),q.bind(i),K.bind(i),H.bind(i)),this.$link=this.$view.apply(i),(this.$link instanceof I||Array.isArray(this.$link))&&(this.$link=z.call(i,null,this.$link)),this.$html.appendChild(this.$link),this.$html.destroy=function(){const t=this.$link.parentElement,e=t.cloneNode(!1);t.parentNode.insertBefore(e,t),this.unmount(),t.parentNode.removeChild(t)}.bind(this),this.mount=function(){"function"==typeof r.onMount&&r.onMount.call(i),$.push(this)},this.unmount=function(){"function"==typeof r.onDestroy&&r.onDestroy.call(i);for(var t=0;t<$.length;t++)if($[t].$id===this.$id){$.splice(t,1);break}return this.$link}}get remount(){return this.mount(),this.link}get out(){return this.mount(),this.$html}}var A=function(t,e,n){var r=k(t);if(S(n))r.style[e]=n.get(),n.watch(t=>{});else if(void 0!==n)r.style[e]=n;else if(N(e))r.setAttribute("style",e);else for(var i in e)A(r,i,e[i])},C=function(t,e,n){var r=this,i=k(t);if(void 0!==n)"style"===e?A(i,n):"model"===e&&S(n)?(i.value=n.get(),i.oninput=function(){n.data()[n.prop]=i.value},n.watch(function(t){})):O(n)?i[e]=function(t){n.call(r,t)}:S(n)?(i.setAttribute(e,n.get()),n.watch(function(t){})):i.setAttribute(e,n);else for(var o in e)C.call(this,i,o,e[o])},k=function(t){return t.nodeType&&t||!t.el&&t||k(t.el)},N=function(t){return"string"==typeof t},E=function(t){return"number"==typeof t},O=function(t){return"function"==typeof t},x=function(t){return t&&t.nodeType},S=function(t){return t&&t instanceof b},D=function(t){return t&&t instanceof J},T=function(t){return t&&t.__radi};const M=function(t){return document.createTextNode(t)};var P=function(t,e){for(var n=0;n<e.length;n++){var r=e[n];if(0===r||r)if(T(r))t.appendChild(r.__radi().out);else if(D(r)){var i,o=r.__do(),a=o.id;i=N(o.r)||E(o.r)?M(o.r):o.r,t.appendChild(i),function(t){t.watch(function(e){var n,r=t.__do();if(a===r.id)return!1;n=N(r.r)||E(r.r)?M(r.r):r.r,i.parentNode.replaceChild(n,i),i=n,a=r.id})}(r)}else if("function"==typeof r)r.call(this,t);else if(N(r)||E(r))t.appendChild(M(r));else if(x(k(r)))t.appendChild(r);else if(Array.isArray(r))P.call(this,t,r);else if(S(r)){let e=M(r.get());t.appendChild(e),r.watch(function(t){})}else"object"==typeof r&&C.call(this,t,r)}},F={},R=function(t){return F[t]||(F[t]=m(t))};const z=function(t){for(var e,n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];return e=N(t)?R(t).cloneNode(!1):x(t)?t.cloneNode(!1):document.createDocumentFragment(),P.call(this,e,n),e};z.extend=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var r=R(t);return z.bind.apply(z,[this,r].concat(e))};const B=function(t){for(var o=t.view.toString().replace(e,""),a=n.exec(o),s=[],c=0;null!==a;){var u=a.index,l=a.input;const t=l.length;for(var f=1,h=0,p=u+2;p<t;p++){var d=l.charCodeAt(p);if(d===r?f+=1:d===i&&(h+=1),f===h)break}var v=l.substr(u,p+1-u),_=v.match(/[a-zA-Z_$]+(?:\.\w+(?:\[.*\])?)+/g)||[],b=_.length>0?_.join("__ob__,")+"__ob__":"",y="l(function(){ return "+v.substr(1)+"; },["+b+'], "'+_.join(",")+'")';s.push(o.substr(c,u-c)),s.push(y),c=u+v.length,a=n.exec(o)}return s.push(o.substr(c,o.length-c)),t.$view=s.join(""),I.bind(this,t)};var I=function(t){this.o={name:t.name,state:f(t.state),props:f(t.props),actions:t.actions,view:t.view,$view:t.$view},this.__radi=function(){return new j(this.o)}};I.prototype.props=function(t){for(var e in t)void 0===this.o.props[e]&&console.warn("[Radi.js] Warn: Creating a prop `",e,"` that is not defined in component"),this.o.props[e]=t[e];return this};const W=function(t,e){const n=e.constructor===String?document.getElementById(e):e;var r=t instanceof I?t.__radi().out:t;return n.appendChild(r),r};var Z=M("");const q=function(t,e){if(!t)return"";var n,r=this,i=document.createDocumentFragment(),o=Z.cloneNode();i.appendChild(o);var a=t.get();if(l(a))for(var s=0;s<a.length;s++)a[s+"__ob__"].watch(t=>{}),i.appendChild(e.call(r,a[s],s));else{s=0;for(var c in a)a[s+"__ob__"].watch(t=>{}),i.appendChild(e.call(r,a[c],c,s)),s++}n=i.lastChild;var u=function(t,o){if(t>0){for(var a=o.length-t;a<o.length;a++)o[a+"__ob__"].watch(t=>{}),i.appendChild(e.call(r,o[a],a));var s=i.lastChild;n.parentElement.insertBefore(i,n.nextSibling),n=s}else if(t<0)for(a=0;a<Math.abs(t);a++){var c=n.previousSibling;n.parentElement.removeChild(n),n=c}};return t.watch&&t.watch(u),t.get&&t.get()._r_get&&t.get()._r_get(u),i},G=function(t,e,n){var r,i={s:null},o=this,a=t.bind(this);if(1===n.length&&t.toString().replace(/(function \(\)\{ return |\(|\)|\; \})/g,"").trim()===n[0])return e[0];for(var s=0;s<e.length;s++)S(e[s])&&(r=!0,e[s].watch(function(){i.s=a(o)}));return i.s=a(o),r?_(i,"s"):i.s},H=function(t,e){return new J(t,e)};var J=function(t,e){this.cases=[{a:t,e:e}],this.w=[],this.els=Z.cloneNode(),S(t)&&this.w.push(t),this.watch=function(t){for(var e in this.w)this.w[e].watch(t)},this.__do=function(){var t={id:null};for(var e in this.cases){if(S(this.cases[e].a)?this.cases[e].a.get():this.cases[e].a){t.id=e,t.r=this.cases[e].e;break}}return void 0===t.r&&(t.r=this.els),t}};J.prototype.elseif=function(t,e){return this.cases.push({a:t,e:e}),S(t)&&this.w.push(t),this},J.prototype.cond=J.prototype.elseif,J.prototype.else=function(t){return this.els=t,this};var K=function(t,e,n){return e?G.call(this,t,e,n.split(",")):t};window.radi={freeze:()=>{s=!0},unfreeze:()=>{s=!1;for(var t=0;t<$.length;t++)"function"==typeof $[t].$this.onMount&&$[t].$this.onMount.call($[t].$this)},r:z,l:K,list:q,version:"0.0.2",component:B,mount:W,activeComponents:$},t.version="0.0.2",t.activeComponents=$,t.text=M,t.r=z,t.component=B,t.mount=W,t.list=q,t.link=G,t.cond=H});
//# sourceMappingURL=radi.js.map