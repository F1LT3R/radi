!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd||e(t.radi={})}(this,function(t){"use strict";var e=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,n=/\bl\(/g,r="(".charCodeAt(0),i=")".charCodeAt(0),o="#".charCodeAt(0),a=".".charCodeAt(0),s=!1,c=Object.prototype,u=function(t){return t&&t.__proto__===c},l=function(t){return!0===Array.isArray(t)};function f(t){var e,n;if("object"==typeof t){if(null===t)return t;if("[object Array]"===Object.prototype.toString.call(t)){var r=t.length;for(n=new Array(r),e=0;e<r;e++)"object"==typeof t[e]?n[e]=f(t[e]):n[e]=t[e]}else for(e in n={},t)t.hasOwnProperty(e)&&(t[e],n[e]=f(t[e]))}else n=t;return n}Object.defineProperties(Object,{relocate:{configurable:!0,enumerable:!1,value:function(t,e){for(var n in e){const i=e[n];var r=!1;!i||"object"!=typeof i||i instanceof $?t[n]!==i&&(r=!0,t[n]=i):(void 0===t[n]&&(t[n]=i.constructor()),Object.relocate(t[n],i),r=!0),r&&p(t,n)}},writable:!0}});var h=function(t,e){var n=()=>{},r=t=>({value:function(){return function(){var t=this[0].length,e=f(this[0]),n=Array.prototype[this[1]].apply(e,arguments),r=e.length,i=r-t;if(this[0].length=r,i<0)for(var o=t;o>t+i;o--)delete this[0][o-1+"__ob__"],delete this[0][o-1];return Object.relocate(this[0],e),0!==i&&this[0]._r_set(i,this[0]),n}.apply([this,t],arguments)}});e._r_set={value:function(e){if(s)return!1;n(e,t)}},e._r_get={value:function(t){n=t}},e.push=r("push"),e.pop=r("pop"),e.splice=r("splice"),e.shift=r("shift"),e.unshift=r("unshift"),e.reverse=r("reverse")},p=function(t,e){if(void 0!==t[e+"__ob__"])return!1;var n={__r:{value:!0}};return l(t)&&void 0===t.__r&&!t.__r&&h(t,n),n[e+"__ob__"]={value:v(t,e),configurable:!0},"object"==typeof t[e]&&d(t[e]),Object.defineProperties(t,n)},d=function t(e){if(e&&"object"==typeof e){var n={__r:{value:!0}};if(l(e))for(var r in void 0!==e.__r||e.__r||h(e,n),e)void 0===e[r+"__ob__"]&&(n[r+"__ob__"]={value:v(e,r),configurable:!0},t(e[r]));else if(u(e))for(var r in e)void 0===e[r+"__ob__"]&&(n[r+"__ob__"]={value:v(e,r),configurable:!0},t(e[r]));return Object.defineProperties(e,n)}return!1},v=function(t,e){return new _(t,e)},_=function(t,e){var n=t;this.watch=function(t){g(n,e,(t,e,n)=>n)},this.prop=e,this.data=function(){return n},this.get=function(){return n[e]}},b=Object.getOwnPropertyDescriptor,g=function(t,e,n){t[e],void 0!==b(t,e)&&b(t,e).set;delete t[e]},y=function(t,e){var n=function(t){for(var e=null,n=null,r=null,i=0,s="",c=0;c<=t.length;c++){var u=t.charCodeAt(c),l=u===o,f=u===a;l||f||!u?(0===i?e=0===c?"div":s:1===i?n=s:r?r+=" "+s:r=s,l?i=1:f&&(i=2),s=""):s+=t[c]}return{tag:e,id:n,className:r}}(t),r=n.tag,i=n.id,s=n.className,c=e?document.createElementNS(e,r):document.createElement(r);return i&&(c.id=i),s&&(e?c.setAttribute("class",s):c.className=s),c};Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var w=0;const m=[];class ${constructor(t){var e=t.state||{},n=t.props||{},r=t.actions||{};t.view;this.$id=w++,this.$this={};var i=this.$this;for(var o in e){if(void 0!==i[o])throw new Error("[Radi.js] Err: Trying to write state for reserved variable `"+o+"`");i[o]=e[o]}for(var o in n){if(void 0!==i[o])throw new Error("[Radi.js] Err: Trying to write prop for reserved variable `"+o+"`");x(n[o])?(i[o]=n[o].get(),n[o].watch(function(t){i[o]=t})):i[o]=n[o]}for(var o in d(i),r){if(void 0!==i[o])throw new Error("[Radi.js] Error: Trying to write action for reserved variable `"+o+"`");{const t=r[o];i[o]=function(){return s?function(){}:t.apply(i,arguments)},function(t,e){t[e]}(i,o)}}i.$id=this.$id,i.$name=t.name,i.$state=e,i.$props=n,i.$actions=r,this.$html=document.createDocumentFragment(),this.$view=new Function("r","list","l","cond","return "+t.$view)(F.bind(i),W.bind(i),G.bind(i),Z.bind(i)),this.$link=this.$view.apply(i),(this.$link instanceof z||Array.isArray(this.$link))&&(this.$link=F.call(i,null,this.$link)),this.$html.appendChild(this.$link),this.$html.destroy=function(){const t=this.$link.parentElement,e=t.cloneNode(!1);t.parentNode.insertBefore(e,t),this.unmount(),t.parentNode.removeChild(t)}.bind(this),this.mount=function(){"function"==typeof r.onMount&&r.onMount.call(i),m.push(this)},this.unmount=function(){"function"==typeof r.onDestroy&&r.onDestroy.call(i);for(var t=0;t<m.length;t++)if(m[t].$id===this.$id){m.splice(t,1);break}return this.$link}}get remount(){return this.mount(),this.link}get out(){return this.mount(),this.$html}}var j=function(t,e,n){var r=C(t);if(x(n))r.style[e]=n.get(),n.watch(t=>{});else if(void 0!==n)r.style[e]=n;else if(k(e))r.setAttribute("style",e);else for(var i in e)j(r,i,e[i])},A=function(t,e,n){var r=this,i=C(t);if(void 0!==n)"style"===e?j(i,n):"model"===e&&x(n)?(i.value=n.get(),i.oninput=function(){n.data()[n.prop]=i.value},n.watch(function(t){})):E(n)?i[e]=function(t){n.call(r,t)}:x(n)?(i.setAttribute(e,n.get()),n.watch(function(t){})):i.setAttribute(e,n);else for(var o in e)A.call(this,i,o,e[o])},C=function(t){return t.nodeType&&t||!t.el&&t||C(t.el)},k=function(t){return"string"==typeof t},N=function(t){return"number"==typeof t},E=function(t){return"function"==typeof t},O=function(t){return t&&t.nodeType},x=function(t){return t&&t instanceof _},S=function(t){return t&&t instanceof q},D=function(t){return t&&t.__radi};const T=function(t){return document.createTextNode(t)};var M=function(t,e){for(var n=0;n<e.length;n++){var r=e[n];if(0===r||r)if(D(r))t.appendChild(r.__radi().out);else if(S(r)){var i,o=r.__do(),a=o.id;i=D(o.r)?o.r.__radi().out:"function"==typeof o.r?o.r():k(o.r)||N(o.r)?T(o.r):o.r,t.appendChild(i),function(t){t.watch(function(e){var n,r=t.__do();if(a===r.id)return!1;n=D(r.r)?r.r.__radi().out:"function"==typeof r.r?r.r():k(r.r)||N(r.r)?T(r.r):r.r,i.parentNode.replaceChild(n,i),i=n,a=r.id})}(r)}else if("function"==typeof r)r.call(this,t);else if(k(r)||N(r))t.appendChild(T(r));else if(O(C(r)))t.appendChild(r);else if(Array.isArray(r))M.call(this,t,r);else if(x(r)){let e=T(r.get());t.appendChild(e),r.watch(function(t){})}else"object"==typeof r&&A.call(this,t,r)}},P={},R=function(t){return P[t]||(P[t]=y(t))};const F=function(t){for(var e,n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];return e=k(t)?R(t).cloneNode(!1):O(t)?t.cloneNode(!1):document.createDocumentFragment(),M.call(this,e,n),e};F.extend=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var r=R(t);return F.bind.apply(F,[this,r].concat(e))};var z=function(t){this.o={name:t.name,state:f(t.state),props:f(t.props),actions:t.actions,view:t.view,$view:t.$view},this.__radi=function(){return new $(this.o)}};z.prototype.props=function(t){for(var e in t)void 0===this.o.props[e]&&console.warn("[Radi.js] Warn: Creating a prop `",e,"` that is not defined in component"),this.o.props[e]=t[e];return this};var B=T("");const W=function(t,e){if(!t)return"";var n,r=this,i=document.createDocumentFragment(),o=B.cloneNode();i.appendChild(o);var a=t.get();if(l(a))for(var s=0;s<a.length;s++)a[s+"__ob__"].watch(t=>{}),i.appendChild(e.call(r,a[s],s));else{s=0;for(var c in a)a[s+"__ob__"].watch(t=>{}),i.appendChild(e.call(r,a[c],c,s)),s++}n=i.lastChild;var u=function(t,o){if(t>0){for(var a=o.length-t;a<o.length;a++)o[a+"__ob__"].watch(t=>{}),i.appendChild(e.call(r,o[a],a));var s=i.lastChild;n.parentElement.insertBefore(i,n.nextSibling),n=s}else if(t<0)for(a=0;a<Math.abs(t);a++){var c=n.previousSibling;n.parentElement.removeChild(n),n=c}};return t.watch&&t.watch(u),t.get&&t.get()._r_get&&t.get()._r_get(u),i},I=function(t,e,n){var r,i={s:null},o=this,a=t.bind(this);if(1===n.length&&t.toString().replace(/(function \(\)\{ return |\(|\)|\; \})/g,"").trim()===n[0])return e[0];for(var s=0;s<e.length;s++)x(e[s])&&(r=!0,e[s].watch(function(){i.s=a(o)}));return i.s=a(o),r?v(i,"s"):i.s},Z=function(t,e){return new q(t,e)};var q=function(t,e){this.cases=[{a:t,e:e}],this.w=[],this.els=B.cloneNode(),x(t)&&this.w.push(t),this.watch=function(t){for(var e in this.w)this.w[e].watch(t)},this.__do=function(){var t={id:null};for(var e in this.cases){if(x(this.cases[e].a)?this.cases[e].a.get():this.cases[e].a){t.id=e,t.r=this.cases[e].e;break}}return void 0===t.r&&(t.r=this.els),t}};q.prototype.elseif=function(t,e){return this.cases.push({a:t,e:e}),x(t)&&this.w.push(t),this},q.prototype.cond=q.prototype.elseif,q.prototype.else=function(t){return this.els=t,this};const G=function(t,e,n){return e?I.call(this,t,e,n.split(",")):t};t.version="0.0.2",t.activeComponents=m,t.text=T,t.r=F,t.component=function(t){for(var o=t.view.toString().replace(e,""),a=n.exec(o),s=[],c=0;null!==a;){var u=a.index,l=a.input,f=1,h=0;const t=l.length;for(var p=u+2;p<t;p++){var d=l.charCodeAt(p);if(d===r?f+=1:d===i&&(h+=1),f===h)break}var v=l.substr(u,p+1-u),_=v.match(/[a-zA-Z_$]+(?:\.\w+(?:\[.*\])?)+/g)||[],b=_.length>0?_.join("__ob__,")+"__ob__":"",g="l(function(){ return "+v.substr(1)+"; },["+b+'], "'+_.join(",")+'")';s.push(o.substr(c,u-c)),s.push(g),c=u+v.length,a=n.exec(o)}return s.push(o.substr(c,o.length-c)),t.$view=s.join(""),z.bind(this,t)},t.mount=function(t,e){const n=e.constructor===String?document.getElementById(e):e;var r=t instanceof z?t.__radi().out:t;return n.appendChild(r),r},t.list=W,t.link=I,t.cond=Z,t.l=G,t.use=function(t){"function"==typeof window.radi[t]?window.radi[t]():console.warn("[Radi.js] Warn: Cannot find plugin `",t)},t.freeze=(()=>{s=!0}),t.unfreeze=(()=>{s=!1;for(var t=0;t<m.length;t++)"function"==typeof m[t].$this.onMount&&m[t].$this.onMount.call(m[t].$this)})});
//# sourceMappingURL=radi.js.map